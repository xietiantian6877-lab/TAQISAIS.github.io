<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025年福建省·球坦克·LP 中式台球城市精英联赛</title>
    
    <!-- 资源预连接 -->
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    
    <!-- 关键CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- 预加载背景图 -->
    <link rel="preload" href="bg2.webp" as="image" type="image/webp">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#FF2E2E',
                        dark: '#1D2939',
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .bg-gradient-event {
                background: linear-gradient(135deg, #165DFF 0%, #FF2E2E 100%);
            }
            .card-hover {
                @apply transition-all duration-300 hover:shadow-lg hover:-translate-y-1;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.5);
            }
            .nav-transition {
                @apply transition-transform duration-300 ease-in-out;
            }
            .nav-hidden {
                transform: translateY(-100%);
            }
        }
    </style>
    <style>
        /* 全局背景核心样式 */
        body {
            background-image: url('bg2.webp');
            background-attachment: fixed;
            background-size: cover;
            background-position: center 100px; /* 初始位置（顶部/赛事亮点上方） */
            background-repeat: no-repeat;
            transition: background-position 1s ease; /* 平滑过渡 */
        }
        /* 背景上移后位置（赛事亮点及下方） */
        body.bg-moved {
            background-position: center -900px;
        }

        /* 积分表格样式 */
        .score-table-container {
            min-height: 320px;
            scrollbar-width: thin;
            scrollbar-color: rgba(255,255,255,0.4) transparent;
        }
        .score-table-container::-webkit-scrollbar {
            height: 7px;
        }
        .score-table-container::-webkit-scrollbar-thumb {
            background-color: rgba(255,255,255,0.4);
            border-radius: 4px;
        }
        .score-table {
            width: 1200px !important;
            margin: 0 auto !important;
        }
        @media (max-width: 768px) {
            .score-table th:nth-child(21),
            .score-table td:nth-child(21) {
                right: 0 !important;
                box-shadow: -2px 0 6px rgba(0,0,0,0.15);
            }
            .score-table th:not(:nth-child(21)),
            .score-table td:not(:nth-child(21)) {
                padding: 6px 3px !important;
                font-size: 11px !important;
            }
        }
    </style>
</head>
<body class="font-sans text-dark">
    <!-- 粘性导航容器 -->
    <div class="sticky top-0 z-50 bg-white/90 backdrop-blur-sm shadow-sm" id="stickyContainer">
        <!-- 导航栏 -->
        <header id="mainNav" class="nav-transition relative z-10">
            <div class="container mx-auto px-4">
                <div class="flex items-center justify-between h-16 md:h-20">
                    <!-- 左侧Logo -->
                    <div class="flex items-center">
                        <img src="logo2-14.webp" alt="球坦克 × LP" class="h-8 md:h-10 mr-2" loading="lazy" />
                    </div>

                    <!-- 桌面端导航 -->
                    <nav class="hidden md:flex items-center space-x-1">
                        <a href="#schedule" class="px-4 py-2 rounded-md text-gray-700 hover:bg-primary/10 hover:text-primary transition-all">赛事安排</a>
                        <a href="#scoreboard" class="px-4 py-2 rounded-md text-gray-700 hover:bg-primary/10 hover:text-primary transition-all">选手积分</a>
                        <a href="#finals" class="px-4 py-2 rounded-md text-gray-700 hover:bg-primary/10 hover:text-primary transition-all">总决赛</a>
                        <a href="#contact" class="px-4 py-2 rounded-md text-gray-700 hover:bg-primary/10 hover:text-primary transition-all">联系我们</a>
                    </nav>

                    <!-- 移动端右侧按钮组 -->
                    <div class="flex items-center md:hidden space-x-2">
                        <a href="#schedule" class="px-3 py-2 rounded-md text-gray-700 hover:bg-primary/10 hover:text-primary transition-all text-sm">赛事战况</a>
                        <a href="#scoreboard" class="px-3 py-2 rounded-md text-gray-700 hover:bg-primary/10 hover:text-primary transition-all text-sm">积分排名</a>
                        <button id="menuBtn" class="text-gray-700 focus:outline-none">
                            <i class="fa fa-bars text-xl"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- 移动端导航菜单 -->
            <div id="mobileMenu" class="md:hidden hidden bg-white border-t">
                <div class="container mx-auto px-4 py-3 space-y-1">
                    <a href="#schedule" class="block px-4 py-2 rounded-md text-gray-700 hover:bg-primary/10 hover:text-primary">赛事安排</a>
                    <a href="#scoreboard" class="block px-4 py-2 rounded-md text-gray-700 hover:bg-primary/10 hover:text-primary">选手积分</a>
                    <a href="#finals" class="block px-4 py-2 rounded-md text-gray-700 hover:bg-primary/10 hover:text-primary">总决赛</a>
                    <a href="#contact" class="block px-4 py-2 rounded-md text-gray-700 hover:bg-primary/10 hover:text-primary">联系我们</a>
                    <a href="tel:13305052147" class="block mt-2 px-4 py-2 bg-primary text-white rounded-md text-center">
                        <i class="fa fa-phone mr-1"></i> 13305052147
                    </a>
                </div>
            </div>
        </header>

        <!-- 移动端导航提示 -->
        <div id="slideTip" class="hidden md:hidden absolute top-0 left-0 w-full h-16 md:h-20 flex items-center justify-center text-primary font-medium z-5">
            向右滑动浏览赛事进度 >>
        </div>

        <!-- 站点导航行 -->
        <div id="siteNav" class="bg-white border-b shadow-sm relative z-10">
            <div class="relative h-16 md:h-20 overflow-x-auto">
                <style>
                    .relative::-webkit-scrollbar { display: none; }
                    .relative {
                        -ms-overflow-style: none;
                        scrollbar-width: none;
                    }
                </style>

                <div class="flex h-full px-4 space-x-4 absolute top-0 left-0 justify-center">
                    <!-- 站点列表 -->
                    <div class="flex-shrink-0 flex items-center justify-center px-4 py-2 rounded-md hover:bg-primary/10 transition-colors cursor-pointer w-36 md:w-40">
                        <div class="text-center">
                            <span class="text-xs md:text-sm text-gray-500">第一站</span>
                            <p class="text-sm md:text-base font-medium">泉州</p>
                            <span class="text-xs md:text-sm text-gray-600">10月10日-13日</span>
                        </div>
                    </div>
                    <div class="flex-shrink-0 flex items-center justify-center px-4 py-2 rounded-md hover:bg-primary/10 transition-colors cursor-pointer w-36 md:w-40">
                        <div class="text-center">
                            <span class="text-xs md:text-sm text-gray-500">第二站</span>
                            <p class="text-sm md:text-base font-medium">厦门</p>
                            <span class="text-xs md:text-sm text-gray-600">10月16日-19日</span>
                        </div>
                    </div>
                    <div class="flex-shrink-0 flex items-center justify-center px-4 py-2 rounded-md hover:bg-primary/10 transition-colors cursor-pointer w-36 md:w-40">
                        <div class="text-center">
                            <span class="text-xs md:text-sm text-gray-500">第三站</span>
                            <p class="text-sm md:text-base font-medium">漳州</p>
                            <span class="text-xs md:text-sm text-gray-600">10月22日-25日</span>
                        </div>
                    </div>
                    <div class="flex-shrink-0 flex items-center justify-center px-4 py-2 rounded-md hover:bg-primary/10 transition-colors cursor-pointer w-36 md:w-40">
                        <div class="text-center">
                            <span class="text-xs md:text-sm text-gray-500">第四站</span>
                            <p class="text-sm md:text-base font-medium">龙岩</p>
                            <span class="text-xs md:text-sm text-gray-600">10月28日-31日</span>
                        </div>
                    </div>
                    <div class="flex-shrink-0 flex items-center justify-center px-4 py-2 rounded-md hover:bg-primary/10 transition-colors cursor-pointer w-36 md:w-40">
                        <div class="text-center">
                            <span class="text-xs md:text-sm text-gray-500">第五站</span>
                            <p class="text-sm md:text-base font-medium">三明</p>
                            <span class="text-xs md:text-sm text-gray-600">11月3日-6日</span>
                        </div>
                    </div>
                    <div class="flex-shrink-0 flex items-center justify-center px-4 py-2 rounded-md hover:bg-primary/10 transition-colors cursor-pointer w-36 md:w-40">
                        <div class="text-center">
                            <span class="text-xs md:text-sm text-gray-500">第六站</span>
                            <p class="text-sm md:text-base font-medium">南平</p>
                            <span class="text-xs md:text-sm text-gray-600">11月9日-12日</span>
                        </div>
                    </div>
                    <div class="flex-shrink-0 flex items-center justify-center px-4 py-2 rounded-md hover:bg-primary/10 transition-colors cursor-pointer w-36 md:w-40">
                        <div class="text-center">
                            <span class="text-xs md:text-sm text-gray-500">第七站</span>
                            <p class="text-sm md:text-base font-medium">宁德</p>
                            <span class="text-xs md:text-sm text-gray-600">11月15日-18日</span>
                        </div>
                    </div>
                    <div class="flex-shrink-0 flex items-center justify-center px-4 py-2 rounded-md hover:bg-primary/10 transition-colors cursor-pointer w-36 md:w-40">
                        <div class="text-center">
                            <span class="text-xs md:text-sm text-gray-500">第八站</span>
                            <p class="text-sm md:text-base font-medium">福州</p>
                            <span class="text-xs md:text-sm text-gray-600">11月21日-24日</span>
                        </div>
                    </div>
                    <div class="flex-shrink-0 flex items-center justify-center px-4 py-2 rounded-md hover:bg-primary/10 transition-colors cursor-pointer w-36 md:w-40">
                        <div class="text-center">
                            <span class="text-xs md:text-sm text-gray-500">第九站</span>
                            <p class="text-sm md:text-base font-medium">莆田</p>
                            <span class="text-xs md:text-sm text-gray-600">11月27日-30日</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 导航与滚动逻辑 -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const menuBtn = document.getElementById('menuBtn');
            const mobileMenu = document.getElementById('mobileMenu');
            const mainNav = document.getElementById('mainNav');
            const stickyContainer = document.getElementById('stickyContainer');
            const slideTip = document.getElementById('slideTip');
            const siteNav = document.getElementById('siteNav');
            let lastScrollTop = 0;
            let isMenuOpen = false;

            // 移动端菜单切换
            menuBtn.addEventListener('click', function() {
                isMenuOpen = !isMenuOpen;
                mobileMenu.classList.toggle('hidden');
                
                if (isMenuOpen) {
                    mainNav.classList.remove('nav-hidden');
                    siteNav.classList.add('hidden');
                    slideTip.classList.add('hidden');
                    stickyContainer.classList.add('shadow-md');
                } else {
                    siteNav.classList.remove('hidden');
                    toggleSlideTip();
                }
            });

            // 滚动逻辑（导航栏显示/隐藏）
            window.addEventListener('scroll', function() {
                const currentScrollTop = window.scrollY;
                const isMobile = window.innerWidth < 768;

                if (isMenuOpen) return;

                if (!isMobile) {
                    if (currentScrollTop > 100) {
                        stickyContainer.classList.add('shadow-md');
                    } else {
                        mainNav.classList.remove('nav-hidden');
                        if (currentScrollTop <= 50) {
                            stickyContainer.classList.remove('shadow-md');
                        }
                    }
                } else {
                    if (currentScrollTop > lastScrollTop && currentScrollTop > 100) {
                        mainNav.classList.add('nav-hidden');
                        stickyContainer.classList.add('shadow-md');
                    } else {
                        mainNav.classList.remove('nav-hidden');
                        if (currentScrollTop <= 50) {
                            stickyContainer.classList.remove('shadow-md');
                        }
                    }
                }

                toggleSlideTip();
                lastScrollTop = currentScrollTop < 0 ? 0 : currentScrollTop;
            });

            // 平滑滚动（锚点跳转）
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    if (isMenuOpen) {
                        isMenuOpen = false;
                        mobileMenu.classList.add('hidden');
                        siteNav.classList.remove('hidden');
                    }

                    const targetId = this.getAttribute('href');
                    if (targetId === '#') return;

                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        const offset = mainNav.classList.contains('nav-hidden') ? 40 : 80;
                        window.scrollTo({
                            top: targetElement.offsetTop - offset,
                            behavior: 'smooth'
                        });
                    }
                });
            });

            // 移动端导航提示显示控制
            function toggleSlideTip() {
                if (mainNav.classList.contains('nav-hidden') && !isMenuOpen) {
                    slideTip.classList.remove('hidden');
                } else {
                    slideTip.classList.add('hidden');
                }
            }
        });
    </script>

    <!-- 赛事头部区域（上方区域，需恢复背景） -->
    <section class="text-white py-16 md:py-24 relative overflow-hidden">
        <div class="absolute inset-0 bg-black/30 z-0"></div>
        <div class="absolute top-10 left-10 w-20 h-20 rounded-full bg-white/10"></div>
        <div class="absolute bottom-10 right-10 w-32 h-32 rounded-full bg-white/10"></div>
        <div class="absolute top-1/2 left-1/3 w-16 h-16 rounded-full bg-white/10"></div>
        
        <div class="container mx-auto px-4 text-center relative z-10">
            <div class="flex flex-col justify-center items-center mb-4">
                <img src="logo-14外发光.webp" alt="球坦克LP球杆杯·中式台球城市精英联赛" class="h-10 mx-2" loading="lazy" />
            </div>
            <img src="球杆杯.webp" alt="球杆杯" class="block mx-auto my-18 h-16 md:h-28" loading="lazy" />
            <h2 class="text-[clamp(1.5rem,4vw,3rem)] font-bold mb-8 text-shadow">福建省中式台球城市精英联赛</h2>
            <div class="flex flex-wrap justify-center gap-4 md:gap-8 mb-10">
                <div class="bg-white/10 backdrop-blur-sm px-4 py-2 rounded-lg">九座城市</div>
                <div class="bg-white/10 backdrop-blur-sm px-4 py-2 rounded-lg">九站连打</div>
                <div class="bg-white/10 backdrop-blur-sm px-4 py-2 rounded-lg">角逐省冠</div>
            </div>
            <div class="bg-white/10 backdrop-blur-sm rounded-xl inline-block px-6 py-3 text-lg font-bold">
                冠军奖金：50,000元
            </div>
        </div>
    </section>

    <!-- 赛事站点列表（上方区域，需恢复背景） -->
    <section id="schedule" class="py-16 relative">
        <div class="absolute inset-0 bg-white/0 backdrop-blur-sm z-0"></div>
        <div class="container mx-auto px-0 relative z-10">
            <div class="text-center mb-12 px-4">
                <img src="赛程上.webp" 
                     alt="赛事站点安排标题" 
                     class="w-full max-w-3xl mx-auto h-auto" 
                     style="object-fit: contain;"
                     loading="lazy">
            </div>
            <div class="w-full">
                <img src="赛事站点.webp" 
                     alt="赛事站点安排" 
                     class="w-full h-auto object-cover mx-auto"
                     style="max-width: 100vw;"
                     loading="lazy">
            </div>
        </div>
    </section>

    <!-- 赛事亮点区域（分界点） -->
    <section id="highlights-section" class="py-16 relative overflow-hidden">
        <div class="absolute inset-0 bg-black/0 backdrop-blur-sm z-0"></div>
        <div class="container mx-auto px-4 relative z-10">
            <div class="text-center mb-12">
                <div class="text-center mb-12">
            <img src="赛事亮点标题图片.webp"  alt="赛事亮点"class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold mb-4 text-primary mx-auto"  style="max-width: 100%; height: auto;"  loading="lazy" >
        </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-5xl mx-auto">
                <div class="bg-white rounded-xl p-6 shadow-sm text-center card-hover">
                    <div class="w-16 h-1 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fa fa-trophy text-2xl text-primary"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">高额奖金</h3>
                    <p class="text-gray-600">总决赛冠军奖金高达50,000元，各分站赛均有丰厚奖励</p>
                </div>
                
                <div class="bg-white rounded-xl p-6 shadow-sm text-center card-hover">
                    <div class="w-16 h-1 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fa fa-map-marker text-2xl text-primary"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">九城联动</h3>
                    <p class="text-gray-600">覆盖福建省九个主要城市，让更多爱好者参与其中</p>
                </div>
                
                <div class="bg-white rounded-xl p-6 shadow-sm text-center card-hover">
                    <div class="w-16 h-1 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fa fa-users text-2xl text-primary"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">精英汇聚</h3>
                    <p class="text-gray-600">汇聚各地台球精英，切磋技艺，提升福建台球水平</p>
                </div>
            </div>
        </div>

        <!-- 核心修复：背景位置控制逻辑 -->
        <script>
            const highlightsSection = document.getElementById('highlights-section');
            // 获取赛事亮点区域的顶部位置（作为判断基准）
            const highlightsTop = highlightsSection.offsetTop;
            
            // 双重判断：既监听元素可见性，也监听滚动位置（确保顶部恢复）
            function updateBackground() {
                const scrollTop = window.scrollY;
                const viewportHeight = window.innerHeight;
                
                // 当滚动到顶部（scrollTop < 100），强制恢复背景
                if (scrollTop < 100) {
                    document.body.classList.remove('bg-moved');
                    return;
                }
                
                // 当滚动位置超过赛事亮点区域顶部50px，背景上移
                if (scrollTop > highlightsTop - 50) {
                    document.body.classList.add('bg-moved');
                } else {
                    // 未超过时（在上方区域），恢复背景
                    document.body.classList.remove('bg-moved');
                }
            }
            
            // 初始加载时执行一次
            updateBackground();
            
            // 监听滚动事件（更直接的位置判断，避免Observer延迟）
            window.addEventListener('scroll', updateBackground);
        </script>
    </section>

    <!-- 选手积分区域（下方区域，背景保持上移） -->
    <section id="scoreboard" class="py-16 relative overflow-hidden">
        <div class="absolute inset-0 bg-white/0 backdrop-blur-sm z-0"></div>
        <div class="container mx-auto px-4 text-center relative z-10">
            <img src="选手积分标题图片.webp"  alt="选手积分"class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold mb-8 text-primary mx-auto"  style="max-width: 100%; height: auto;"  loading="lazy">
            <div id="excelTable" class="overflow-x-auto score-table-container" style="width: 100%;"></div>
            <p class="mt-6 text-white">注：此表格仅展示前100选手比赛积分</p>
        </div>
    </section>

    <!-- 总决赛区域（下方区域，背景保持上移） -->
    <section id="finals" class="py-16 bg-gradient-to-r from-primary to-secondary text-white relative overflow-hidden">
        <div class="absolute -top-20 -right-20 w-64 h-64 rounded-full bg-white/5"></div>
        <div class="absolute -bottom-10 -left-10 w-40 h-40 rounded-full bg-white/5"></div>
        
        <div class="container mx-auto px-4 text-center relative z-10">
            <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold mb-4 text-shadow">福建省联赛总决赛</h2>
            <p class="text-xl mb-8">12月20日 - 25日</p>
            <div class="inline-block bg-white/20 backdrop-blur-sm rounded-xl px-8 py-6 mb-8 max-w-lg">
                <h3 class="text-2xl font-bold mb-4">冠军奖金：50,000元</h3>
                <p class="text-white/90 mb-4">总决赛汇集各分站赛优胜者，角逐省总冠军及高额奖金</p>
                <p class="text-white/90">具体地点另行通知，敬请关注各站点动态</p>
            </div>
            
            <div class="flex flex-wrap justify-center gap-6 mb-8">
                <div class="bg-white/10 backdrop-blur-sm rounded-lg px-4 py-2">
                    <p class="font-bold">亚军奖金</p>
                    <p>20,000元</p>
                </div>
                <div class="bg-white/10 backdrop-blur-sm rounded-lg px-4 py-2">
                    <p class="font-bold">季军奖金</p>
                    <p>10,000元</p>
                </div>
                <div class="bg-white/10 backdrop-blur-sm rounded-lg px-4 py-2">
                    <p class="font-bold">殿军奖金</p>
                    <p>5,000元</p>
                </div>
            </div>
            
            <div class="flex flex-wrap justify-center gap-4 opacity-80">
                <div class="bg-white/10 px-3 py-1 rounded">球坦克</div>
                <div class="bg-white/10 px-3 py-1 rounded">LP球杆</div>
                <div class="bg-white/10 px-3 py-1 rounded">美洲豹</div>
                <div class="bg-white/10 px-3 py-1 rounded">环球</div>
                <div class="bg-white/10 px-3 py-1 rounded">达芬尼</div>
            </div>
        </div>
    </section>

    <!-- 页脚（下方区域，背景保持上移） -->
    <footer id="contact" class="bg-dark text-white py-12 relative z-10">
        <div class="container mx-auto px-4">
            <div class="max-w-5xl mx-auto">
                <div class="flex flex-col md:flex-row justify-between items-center mb-8">
                    <div class="mb-6 md:mb-0">
                        <h3 class="text-xl font-bold mb-2">中式台球城市精英联赛</h3>
                        <p class="text-gray-400">球坦克LP球杆杯官方赛事</p>
                    </div>
                    <div class="flex space-x-4">
                        <a href="#" class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center hover:bg-primary transition-colors">
                            <i class="fa fa-weixin"></i>
                        </a>
                        <a href="#" class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center hover:bg-primary transition-colors">
                            <i class="fa fa-weibo"></i>
                        </a>
                        <a href="#" class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center hover:bg-primary transition-colors">
                            <i class="fa fa-qq"></i>
                        </a>
                    </div>
                </div>
                
                <div class="border-t border-gray-800 pt-8 text-center">
                    <p class="mb-4">官方咨询：<a href="tel:13305052147" class="text-secondary font-medium">13305052147</a>（总决赛负责号）</p>
                    <p class="text-gray-500 text-sm">© 2025 球坦克LP球杆杯·中式台球城市精英联赛 版权所有</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- 积分表格加载脚本 -->
    <script defer>
        document.addEventListener('DOMContentLoaded', function() {
            fetch('score.json')
                .then(res => {
                    if (!res.ok) throw new Error('积分数据加载失败（请检查文件路径）');
                    return res.json();
                })
                .then(data => {
                    if (!data.length) {
                        document.getElementById('excelTable').innerHTML = '<p class="text-white/80">暂无积分数据</p>';
                        return;
                    }
                    
                    let html = '<table class="bg-white/10 rounded-xl shadow text-dark score-table" style="width: 1200px; border-collapse: collapse;">';
                    // 表头行
                    html += '<thead><tr>';
                    data[0].forEach((cell, idx) => {
                        if ([2,4,6,8,10,12,14,16,18].includes(idx)) return;
                        const isTotalScore = idx === 20;
                        const thStyle = isTotalScore 
                            ? 'position: sticky; right: 0; z-index: 30; width: 80px; background: #1D2939; color: white;' 
                            : 'background: #165DFF; color: white;';

                        if ([3,5,7,9,11,13,15,17,19].includes(idx)) {
                            html += `<th colspan="2" style="${thStyle} padding: 8px 4px; border: 1px solid #ddd; font-size: 12px; text-align: center;">${data[0][idx-1]}</th>`;
                        } else if (idx === 0 || idx === 1 || idx === 20) {
                            html += `<th rowspan="2" style="${thStyle} padding: 8px 4px; border: 1px solid #ddd; font-size: 12px; text-align: center;">${cell}</th>`;
                        }
                    });
                    html += '</tr><tr>';
                    // 子表头行
                    data[1].forEach((cell, idx) => {
                        if (idx === 0 || idx === 1 || idx === 20) return;
                        html += `<th style="background: #165DFF; color: white; padding: 8px 4px; border: 1px solid #ddd; font-size: 12px; text-align: center;">${cell}</th>`;
                    });
                    html += '</tr></thead><tbody>';

                    // 数据行（最多显示100条）
                    const maxRows = 100;
                    const endIndex = Math.min(2 + maxRows, data.length);
                    for (let i = 2; i < endIndex; i++) {
                        const rowBg = i % 2 ? 'background: rgba(219, 234, 254, 0.3);' : 'background: white;';
                        html += `<tr style="${rowBg}">`;
                        data[i].forEach((cell, idx) => {
                            const isTotalScore = idx === 20;
                            const tdStyle = isTotalScore 
                                ? 'position: sticky; right: 0; z-index: 20; width: 80px; background: rgba(29, 41, 57, 0.9); color: white; font-weight: 500;' 
                                : 'color: #1D2939;';

                            html += `<td style="${tdStyle} padding: 8px 4px; border: 1px solid #ddd; font-size: 12px; text-align: center;">${cell ?? 0}</td>`;
                        });
                        html += '</tr>';
                    }

                    html += '</tbody></table>';
                    document.getElementById('excelTable').innerHTML = html;
                })
                .catch(err => {
                    console.error('积分加载错误：', err);
                    document.getElementById('excelTable').innerHTML = `<p class="text-white/80">${err.message}</p>`;
                });
        });
    </script>
</body>
</html>